import{a as F}from"./chunk-32FL5DMP.js";import{a as H,b as J,c as ee,d as te,f as ie,g as ne,h as oe}from"./chunk-UKZT5LYH.js";import{a as R,b as q,c as G,d as L,g as W,h as Y,i as K,j as Q,k as X}from"./chunk-4BQ3I3IV.js";import"./chunk-Q64FFBLU.js";import{f as re}from"./chunk-2FMEKLYD.js";import{O as Z,P as $}from"./chunk-ADHHZP6M.js";import{b as V,d as I}from"./chunk-ID222W6O.js";import"./chunk-I2VACIZO.js";import"./chunk-MDC4N2GR.js";import{b as E,d as y,f as B,g as T,j as z,k as U,m as j,n as A,o as D,p as N}from"./chunk-PXIP7OAW.js";import"./chunk-OMQHCXRE.js";import{o as k,q as P}from"./chunk-FHMWGGDF.js";import{$b as C,Cb as m,Gb as i,Hb as n,Ib as g,Kb as S,Ma as M,Nb as p,Pb as b,_b as o,ab as l,ac as w,bb as c,fc as O,ka as v,sb as u,ta as _,ua as x,xb as h}from"./chunk-LBNGVE6L.js";function le(r,t){r&1&&(i(0,"mat-error"),o(1,"Email is required"),n())}function ce(r,t){r&1&&(i(0,"mat-error"),o(1,"Password is required"),n())}function pe(r,t){r&1&&(i(0,"mat-error"),o(1,"Password must be at least 6 characters"),n())}function me(r,t){r&1&&o(0," Verify OTP ")}function de(r,t){r&1&&(i(0,"div",16),g(1,"mat-spinner",22),i(2,"span"),o(3,"Connecting..."),n()())}function fe(r,t){if(r&1){let a=S();i(0,"div",21)(1,"button",23),p("click",function(){_(a);let s=b();return x(s.closeSpeechBubble())}),i(2,"mat-icon"),o(3,"close"),n()(),i(4,"div",24),o(5),i(6,"button",25),p("click",function(){_(a);let s=b();return x(s.playMessageManually())}),i(7,"mat-icon"),o(8,"volume_up"),n()()()()}if(r&2){let a=b();l(5),w(" ",a.welcomeMessage," ")}}var ae=class r{constructor(t,a,e,s,d,f){this.fb=t;this.router=a;this.snackBar=e;this.authService=s;this.route=d;this.platformId=f;this.isBrowser=P(this.platformId);let se=this.route.snapshot.queryParams.email;this.otpVerifyForm=this.fb.group({email:[se,[y.required]],otp:["",[y.required,y.minLength(6)]]}),this.isBrowser&&document.addEventListener("click",()=>{console.log("click event occured",this.initialized),this.initialized||(this.initialized=!0,this.initializeSpeech())},{once:!0})}otpVerifyForm;hidePassword=!0;loading=!1;welcomeMessage="Hi, I am Vishnu bot and you can talk directly to me without having to chat";speechSynthesis=null;isBrowser;showSpeechBubble=!0;currentUtterance=null;initialized=!1;initializeSpeech(){if(console.log("init speech called"),"speechSynthesis"in window){console.log("in the if block");try{console.log("trying init speech"),this.speechSynthesis=window.speechSynthesis,this.currentUtterance=new SpeechSynthesisUtterance(this.welcomeMessage),this.currentUtterance.rate=.9,this.currentUtterance.pitch=1,this.currentUtterance.volume=1,this.speechSynthesis.getVoices().length>0?(console.log("getVoice block"),this.setupVoice(),this.playWelcomeMessage()):this.speechSynthesis.onvoiceschanged=()=>{console.log("voice changed block"),this.setupVoice(),this.playWelcomeMessage()},this.currentUtterance.onstart=()=>{console.log("Speech started")},this.currentUtterance.onend=()=>{console.log("Speech ended")},this.currentUtterance.onerror=t=>{console.error("Speech error:",t)}}catch(t){console.error("Speech synthesis initialization error:",t)}}else console.log("speech synthesis is not in window")}setupVoice(){if(!this.currentUtterance||!this.speechSynthesis)return;let t=this.speechSynthesis.getVoices(),a=t.find(e=>e.lang.startsWith("en")&&e.name.toLowerCase().includes("female"))||t.find(e=>e.lang.startsWith("en"))||t[0];a&&(this.currentUtterance.voice=a)}ngOnInit(){}playWelcomeMessage(){if(!(!this.isBrowser||!this.speechSynthesis||!this.currentUtterance))try{this.speechSynthesis.cancel(),this.speechSynthesis.paused&&this.speechSynthesis.resume(),this.speechSynthesis.speak(this.currentUtterance)}catch(t){console.error("Error playing welcome message:",t)}}playMessageManually(){this.currentUtterance&&(this.speechSynthesis?.cancel(),this.speechSynthesis?.speak(this.currentUtterance))}closeSpeechBubble(){this.showSpeechBubble=!1,this.speechSynthesis?.speaking&&this.speechSynthesis.cancel()}onSubmit(){this.otpVerifyForm.valid?(this.loading=!0,setTimeout(()=>{this.loading=!1},2e3),this.authService.otpVerify(this.otpVerifyForm.value).subscribe({next:t=>{window.alert("OTP Verified !!"),console.log("response : ",t),localStorage.setItem("access_token",t.token.access_token),localStorage.setItem("is_super_admin",String(t.user_data.is_super_admin)),localStorage.setItem("current_organization_id",t.user_roles[0].organization_id),this.router.navigate(["/dashboard"])},error:t=>{console.error("Login failed: ",t),window.alert("Please check your credentials"),this.loading=!1}})):this.otpVerifyForm.markAllAsTouched()}signInWithGoogle(){console.log("sign in with google called")}ngOnDestroy(){this.isBrowser&&this.speechSynthesis?.speaking&&this.speechSynthesis.cancel()}static \u0275fac=function(a){return new(a||r)(c(A),c(I),c(ne),c(F),c(V),c(M))};static \u0275cmp=v({type:r,selectors:[["app-otp-verify"]],standalone:!0,features:[O],decls:39,vars:9,consts:[[1,"min-vh-100","otp-verify-container"],[1,"container"],[1,"row","justify-content-center","align-items-center","min-vh-100"],[1,"col-12","col-sm-10","col-md-8","col-lg-6","col-xl-5"],[1,"glass-card","p-4","p-md-5"],[1,"text-center","mb-4"],[1,"avatar-container","mx-auto","mb-4"],["src","logos/logo-2.png","alt","Bot",1,"bot-icon",3,"click"],[1,"text-light","mb-4"],[1,"d-flex","flex-column","gap-4",3,"ngSubmit","formGroup"],["appearance","outline"],["matInput","","formControlName","email","type","text","placeholder","Enter your email"],["matPrefix","",1,"me-2"],["matInput","","formControlName","otp","placeholder","Enter your OTP",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["mat-flat-button","",1,"submit-button","py-3",3,"disabled"],[1,"d-flex","align-items-center","justify-content-center","gap-2"],[1,"bot-placeholder"],[1,"bot-content"],[1,"bot-image","d-flex","align-items-center","justify-content-center"],["src","assets/characters/char-1-removebg.png","alt","Bot",1,"bot-icon",3,"click"],[1,"speech-bubble"],["diameter","20"],[1,"close-button",3,"click"],[1,"speech-content"],[1,"play-button",3,"click"]],template:function(a,e){if(a&1&&(i(0,"p"),o(1,"otp-verify works!"),n(),i(2,"div",0)(3,"div",1)(4,"div",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"img",7),p("click",function(){return e.playMessageManually()}),n()(),i(10,"p",8),o(11,"Otp Verify to your AI assistant"),n()(),i(12,"form",9),p("ngSubmit",function(){return e.onSubmit()}),i(13,"mat-form-field",10)(14,"mat-label"),o(15,"Email"),n(),g(16,"input",11),i(17,"mat-icon",12),o(18,"email"),n(),u(19,le,2,0,"mat-error"),n(),i(20,"mat-form-field",10)(21,"mat-label"),o(22,"OTP"),n(),g(23,"input",13),i(24,"mat-icon",12),o(25,"lock"),n(),i(26,"button",14),p("click",function(){return e.hidePassword=!e.hidePassword}),i(27,"mat-icon"),o(28),n()(),u(29,ce,2,0,"mat-error")(30,pe,2,0,"mat-error"),n(),i(31,"button",15),u(32,me,1,0)(33,de,4,0,"div",16),n()()()()()(),i(34,"div",17)(35,"div",18)(36,"div",19)(37,"img",20),p("click",function(){return e.playMessageManually()}),n()(),u(38,fe,9,1,"div",21),n()()()),a&2){let s,d,f;l(12),h("formGroup",e.otpVerifyForm),l(7),m((s=e.otpVerifyForm.get("email"))!=null&&s.hasError("required")&&((s=e.otpVerifyForm.get("email"))!=null&&s.touched)?19:-1),l(4),h("type",e.hidePassword?"password":"text"),l(5),C(e.hidePassword?"visibility_off":"visibility"),l(),m((d=e.otpVerifyForm.get("password"))!=null&&d.hasError("required")&&((d=e.otpVerifyForm.get("password"))!=null&&d.touched)?29:-1),l(),m((f=e.otpVerifyForm.get("password"))!=null&&f.hasError("minlength")&&((f=e.otpVerifyForm.get("password"))!=null&&f.touched)?30:-1),l(),h("disabled",e.otpVerifyForm.invalid||e.loading),l(),m(e.loading?33:32),l(6),m(e.showSpeechBubble?38:-1)}},dependencies:[D,z,E,B,T,N,U,j,k,Y,W,R,q,G,L,J,H,X,K,Q,$,Z,ie,te,ee,re,oe],styles:['mat-label[_ngcontent-%COMP%]{color:#fff}mat-icon[_ngcontent-%COMP%]{fill:#fff;filter:brightness(0) invert(1)}.google-button[_ngcontent-%COMP%]{background:#ffffff1a;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 32px #0000001a;background-color:#fff}.otp-verify-container[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1e1e2f,#2a2a45);position:relative;overflow:hidden}.otp-verify-container[_ngcontent-%COMP%]:before{content:"";position:absolute;width:200%;height:200%;background:linear-gradient(45deg,#4285f41a,#db44371a,#f4b4001a,#0f9d581a,#4285f41a);animation:_ngcontent-%COMP%_rotate 20s linear infinite}.glass-card[_ngcontent-%COMP%]{background:#ffffff1a;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);border-radius:16px;border:1px solid rgba(255,255,255,.2);box-shadow:0 8px 32px #0003;position:relative}.avatar-container[_ngcontent-%COMP%]{width:250px;height:auto;border-radius:50%;display:flex;align-items:center;justify-content:center}.avatar-icon[_ngcontent-%COMP%]{font-size:40px;width:40px;height:40px;color:#fff}.bot-placeholder[_ngcontent-%COMP%]{position:fixed;bottom:2rem;right:2rem;z-index:1000;display:flex;align-items:flex-end}.bot-content[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;align-items:flex-end}.bot-image[_ngcontent-%COMP%]{width:500px;height:auto;cursor:pointer;transition:transform .3s ease;position:relative;z-index:2}.bot-image[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.bot-icon[_ngcontent-%COMP%]{width:100%;height:auto;cursor:pointer}.bot-icon[_ngcontent-%COMP%]:hover{transform:scale(1.1);transition:transform .2s ease}.speech-bubble[_ngcontent-%COMP%]{position:absolute;bottom:180px;right:0;background:#fff;padding:1rem;border-radius:15px;min-width:200px;max-width:300px;width:max-content;color:#333;box-shadow:0 4px 15px #0000001a;font-size:.9rem;opacity:0;animation:_ngcontent-%COMP%_fadeIn 1s ease forwards 1s;pointer-events:all;z-index:1}.speech-bubble[_ngcontent-%COMP%]:after{content:"";position:absolute;right:50px;bottom:-10px;border-width:10px 10px 0;border-style:solid;border-color:white transparent transparent}.speech-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.play-button[_ngcontent-%COMP%]{background:none;border:none;color:#4285f4;cursor:pointer;padding:4px;display:flex;align-items:center;justify-content:center;transition:all .2s ease;border-radius:50%}.play-button[_ngcontent-%COMP%]:hover{background:#4285f41a;transform:scale(1.1)}.play-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.close-button[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;width:24px;height:24px;border-radius:50%;background:#dc3545;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;padding:0;transition:all .2s ease;box-shadow:0 2px 5px #0003}.close-button[_ngcontent-%COMP%]:hover{background:#c82333;transform:scale(1.1)}.close-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#fff}  .mat-mdc-form-field{width:100%}  .mdc-text-field--outlined{background:#ffffff0d;border-radius:8px}  .mat-mdc-form-field-appearance-outline .mdc-notched-outline__leading,   .mat-mdc-form-field-appearance-outline .mdc-notched-outline__notch,   .mat-mdc-form-field-appearance-outline .mdc-notched-outline__trailing{border-color:#ffffff4d!important}  .mdc-text-field:not(.mdc-text-field--disabled) .mdc-floating-label,   .mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__input{color:#ffffffde!important}.submit-button[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4285f4,#34a853)!important;color:#fff!important;border-radius:8px!important;font-weight:500!important;transition:opacity .3s ease!important}.submit-button[_ngcontent-%COMP%]:hover:not(:disabled){opacity:.9}.submit-button[_ngcontent-%COMP%]:disabled{background:#ffffff1a!important;color:#fff6!important}@keyframes _ngcontent-%COMP%_floatAnimation{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_rotate{0%{transform:translateY(-50%) rotate(0)}to{transform:translateY(-50%) rotate(360deg)}}.hover-effect[_ngcontent-%COMP%]{transition:opacity .3s ease}.hover-effect[_ngcontent-%COMP%]:hover{opacity:.8}@media (max-width: 768px){.bot-placeholder[_ngcontent-%COMP%]{bottom:1rem;right:1rem}.bot-image[_ngcontent-%COMP%]{width:80px;height:80px}.bot-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px}.speech-bubble[_ngcontent-%COMP%]{max-width:200px;font-size:.8rem;bottom:90px;padding:.75rem}}']})};export{ae as OtpVerifyComponent};
